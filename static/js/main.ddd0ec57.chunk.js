(this["webpackJsonptask-timer"]=this["webpackJsonptask-timer"]||[]).push([[0],{122:function(t,e,n){},123:function(t,e,n){},151:function(t,e,n){"use strict";n.r(e);var i=n(6),a=n(0),s=n.n(a),r=n(11),o=n.n(r),c=(n(122),n(16)),u=n(12),l=n(22),d=n(30),h=n(29),f=n(179),b=n(5),m=n(188),p=n(189),j=n(190),x=n(184),v=n(75),g=n(156),O=n(107),k=n.n(O),C=n(108),w=n.n(C),S=(n(123),n(109)),y=n(182),N=n(195),_=n(197),T=n(191),L=n(103),M=n.n(L),E=n(105),I=n.n(E),D=n(104),B=n.n(D),J=Object(b.a)((function(t){return Object(f.a)({fullWidth:{width:"100%"},centeringGrid:{display:"flex"},listItemText:{display:"block"},sliderSpacing:{width:"100%",justifyContent:"center",verticalAlign:"middle"},sliderLabelContainer:{marginBottom:-16},sliderLabel:{paddingRight:10},editContainer:{paddingRight:8,marginTop:-6,marginBottom:-7}})}))(function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).startingLabel=void 0,i.startingMin=void 0,i.startingMax=void 0,i.state={value:i.props.value,min:i.props.min,max:i.props.max,step:i.props.step,label:i.props.label,menuOpen:!1,editing:!1,labelError:!1,minError:!1,maxError:!1},i.handleOnChange=i.handleOnChange.bind(Object(l.a)(i)),i}return Object(u.a)(n,[{key:"handleOnChange",value:function(t,e){"number"===typeof e?this.setState({value:e}):"object"===typeof e&&this.setState({value:e[0]}),this.props.onChange(this.state.value)}},{key:"renderNormalView",value:function(){var t=this,e=this.props.classes;return Object(i.jsxs)(s.a.Fragment,{children:[Object(i.jsxs)(S.a,{id:"normalMenu",keepMounted:!0,open:this.state.menuOpen,anchorEl:this.state.anchor,onClose:function(){t.setState({menuOpen:!1})},children:[Object(i.jsx)(y.a,{onClick:function(){t.startingLabel=t.state.label,t.startingMin=t.state.min,t.startingMax=t.state.max,t.setState({editing:!0})},children:"Edit"}),Object(i.jsx)(y.a,{children:"Delete"})]}),Object(i.jsxs)(N.a,{display:"flex",flexDirection:"row",flex:"100%",alignItems:"baseline",className:e.sliderLabelContainer,children:[Object(i.jsx)(v.a,{variant:"subtitle1",className:e.sliderLabel,children:this.state.label}),Object(i.jsxs)(v.a,{variant:"caption",className:e.sliderLabel,children:["(",this.props.formatCallback(this.state.value),")"]})]}),Object(i.jsxs)(N.a,{display:"flex",flex:1,flexDirection:"row",children:[Object(i.jsx)(N.a,{m:1,flex:"100%",display:"flex",justifyContent:"flex-start",alignItems:"center",children:Object(i.jsx)(_.a,{value:this.state.value,step:this.state.step,min:this.state.min,max:this.state.max,onChange:this.handleOnChange,getAriaValueText:function(t){return"".concat(t,"m")},valueLabelDisplay:"off","aria-labelledby":"break-length"})}),Object(i.jsx)(N.a,{flex:1,display:"flex",justifyContent:"flex-end",alignItems:"center",children:Object(i.jsx)(x.a,{onClick:function(e){t.setState({anchor:e.currentTarget,menuOpen:!0})},children:Object(i.jsx)(M.a,{})})})]})]})}},{key:"renderEditView",value:function(){var t=this,e=this.props.classes;return Object(i.jsx)(s.a.Fragment,{children:Object(i.jsxs)(N.a,{display:"flex",flex:1,flexDirection:"row",children:[Object(i.jsxs)(N.a,{m:1,flex:"100%",display:"flex",justifyContent:"flex-start",alignItems:"center",children:[Object(i.jsx)(N.a,{className:e.editContainer,flex:3,children:Object(i.jsx)(T.a,{fullWidth:!0,label:"Name",error:this.state.labelError,value:this.state.label,margin:"dense",size:"small",variant:"standard",onChange:function(e){t.setState({label:e.target.value,labelError:""===e.target.value})}})}),Object(i.jsx)(N.a,{className:e.editContainer,flex:1,children:Object(i.jsx)(T.a,{label:"Min",error:this.state.minError,size:"small",variant:"outlined",margin:"dense",value:this.state.min,onChange:function(e){var n=parseInt(e.target.value);t.setState({min:n||0,minError:isNaN(n)||n<1})}})}),Object(i.jsx)(N.a,{className:e.editContainer,flex:1,children:Object(i.jsx)(T.a,{label:"Max",error:this.state.maxError,size:"small",variant:"outlined",margin:"dense",value:this.state.max,onChange:function(e){var n=parseInt(e.target.value);t.setState({max:n||0,maxError:isNaN(n)||n<1||n<t.state.min})}})})]}),Object(i.jsxs)(N.a,{flex:1,display:"flex",justifyContent:"flex-end",alignItems:"center",children:[Object(i.jsx)(x.a,{onClick:function(e){var n;n=t.state.value>t.state.max?t.state.max:t.state.value<t.state.min?t.state.min:t.state.value,t.props.onEditSave(t.state.label,t.state.min,t.state.max),t.setState({menuOpen:!1,editing:!1,value:n})},children:Object(i.jsx)(B.a,{})}),Object(i.jsx)(x.a,{onClick:function(e){t.setState({menuOpen:!1,editing:!1}),void 0!==t.startingLabel&&void 0!==t.startingMin&&void 0!==t.startingMax&&t.setState({label:t.startingLabel,min:t.startingMin,max:t.startingMax})},children:Object(i.jsx)(I.a,{})})]})]})})}},{key:"renderCurrentView",value:function(){return this.state.editing?this.renderEditView():this.renderNormalView()}},{key:"render",value:function(){return Object(i.jsx)(N.a,{display:"flex",flexDirection:"column",children:this.renderCurrentView()})}}]),n}(a.Component)),V=n(193),P=n(181),W=n(157),q=n(185),F=n(186),G=n(187),R=n(194),z=n(106),A=n.n(z),U=function(){function t(){Object(c.a)(this,t),this.subscribers=new Map}return Object(u.a)(t,[{key:"subscribe",value:function(t,e){this.subscribers.set(t,e)}},{key:"unsubscribe",value:function(t){this.subscribers.delete(t)}},{key:"updateSubscribers",value:function(){this.subscribers.forEach((function(t,e,n){console.log("updating subscriber ".concat(e)),t()}))}}]),t}(),H=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t;return Object(c.a)(this,n),(t=e.call(this))._desktopNotificationSupport=!1,t._desktopNotificationSupport="Notification"in window,t}return Object(u.a)(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new this)}}]),Object(u.a)(n,[{key:"requestDesktopNotificationPermissions",value:function(){var t=this;this.desktopNotificationSupport&&"default"===Notification.permission&&Notification.requestPermission().then((function(e){t.updateSubscribers()}))}},{key:"showNotification",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t,e){t.close(),window.focus()},i=new Notification(t,e);i.onclick=function(t){return n(i,t)}}},{key:"desktopNotificationSupport",get:function(){return this._desktopNotificationSupport}},{key:"desktopNotificationEnabled",get:function(){return this.desktopNotificationSupport&&"granted"===Notification.permission}}]),n}(U);H._instance=void 0;var K=H.instance,Q=Object(b.a)((function(t){return Object(f.a)({sideBar:{width:250}})}))(function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={open:!1,notificationsEnabled:K.desktopNotificationEnabled},i}return Object(u.a)(n,[{key:"refreshNotificationState",value:function(){this.state.notificationsEnabled!==K.desktopNotificationEnabled&&this.setState({notificationsEnabled:K.desktopNotificationEnabled})}},{key:"componentDidUpdate",value:function(){this.refreshNotificationState()}},{key:"componentDidMount",value:function(){var t=this;K.subscribe(this.constructor.name,(function(){t.refreshNotificationState()}))}},{key:"componentWillUnmount",value:function(){K.unsubscribe(this.constructor.name)}},{key:"render",value:function(){var t=this,e=this.props.classes;return Object(i.jsx)(V.a,{anchor:"left",open:this.props.onOpen(),onClose:function(){return t.props.onClose()},children:Object(i.jsx)("div",{className:e.sideBar,children:Object(i.jsx)(P.a,{children:Object(i.jsxs)(W.a,{button:!0,onClick:function(){K.requestDesktopNotificationPermissions()},children:[Object(i.jsx)(q.a,{children:Object(i.jsx)(A.a,{})}),Object(i.jsx)(F.a,{primary:"Notifications"}),Object(i.jsx)(G.a,{children:Object(i.jsx)(R.a,{edge:"end",onClick:function(){K.requestDesktopNotificationPermissions()},checked:this.state.notificationsEnabled,inputProps:{"aria-labelledby":"switch-list-label-bluetooth"},onFocus:function(){return t.refreshNotificationState()},onBlur:function(){return t.refreshNotificationState()},disabled:!K.desktopNotificationSupport})})]})})})})}}]),n}(a.Component)),X=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NO_NAME",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:90,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3;return Object(c.a)(this,n),(t=e.call(this))._name=i,t._min=a,t._max=s,t._value=r,t._intervalMs=o,t.timeout=void 0,t.startTime=void 0,t._endTime=void 0,t._running=!1,t._secondsLeft=0,t}return Object(u.a)(n,[{key:"loadFromJsonObject",value:function(t){return this.startTime=t.startTime,this._endTime=t.endTime,this._running=t.running,this._secondsLeft=t.secondsLeft,this._name=t.name,this._min=t.min,this._max=t.max,this._value=t.value,this._intervalMs=t.intervalMs,this}},{key:"exportToJsonObject",value:function(){return{startTime:this.startTime,endTime:this.endTime,running:this.running,secondsLeft:this.secondsLeft,name:this.name,min:this.min,max:this.max,value:this.value,intervalMs:this.intervalMs}}},{key:"start",value:function(){this._running=!0,this.startTime=Date.now(),this._endTime=this.startTime+60*this.value*1e3,this.update()}},{key:"stop",value:function(){this._running=!1,this.update()}},{key:"update",value:function(){var t=this;void 0!==this.endTime&&(this._secondsLeft=Math.floor((this.endTime-Date.now())/1e3),this._running&&this.secondsLeft>0?this.timeout=setTimeout((function(){return t.update()}),this.intervalMs):(this._running=!1,this._secondsLeft=0,clearTimeout(this.timeout))),this.updateSubscribers()}},{key:"name",get:function(){return this._name},set:function(t){this._name=t}},{key:"secondsLeft",get:function(){return this._secondsLeft}},{key:"running",get:function(){return this._running}},{key:"value",get:function(){return this._value?this._value:0},set:function(t){this._value=t}},{key:"min",get:function(){return this._min?this._min:1},set:function(t){this._min=t}},{key:"max",get:function(){return this._max?this._max:90},set:function(t){this._max=t}},{key:"intervalMs",get:function(){return this._intervalMs?this._intervalMs:1e3}},{key:"endTime",get:function(){return this._endTime}}]),n}(U),Y=function(){function t(){Object(c.a)(this,t)}return Object(u.a)(t,null,[{key:"seconds",value:function(t){var e=Math.floor(t/60/60),n=Math.floor((t-60*e*60)/60),i=Math.floor(t-60*e*60-60*n),a=[];return e>0&&a.push("".concat(e,"h")),n>0&&a.push("".concat(n,"m")),a.push("".concat(i,"s")),a.join(" ")}},{key:"minutes",value:function(t){var e=Math.floor(t/60),n=t-60*e,i=[];return e>0&&i.push("".concat(e,"h")),i.push("".concat(n,"m")),i.join(" ")}}]),t}(),Z="Task Timer",$=[new X("Work",1,90,50),new X("Break time",1,15,10)],tt=H.instance,et=Object(b.a)((function(t){return Object(f.a)({root:{flexGrow:1},fillWidth:{width:"100%"},menuButton:{marginRight:t.spacing(2)},title:{flexGrow:1},gridContainer:{flexGrow:1,padding:8},paperContainer:{padding:8},sliderBox:{paddingTop:16}})}))(function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={workLength:50,breakLength:10,running:!1,secondsLeft:0,sidebarOpen:!1,notificationSupport:"Notification"in window,countdowns:$,currentCountdownIndex:0},i.handleStartStopOnClick=i.handleStartStopOnClick.bind(Object(l.a)(i)),i.updateCountdownState=i.updateCountdownState.bind(Object(l.a)(i)),i.updateSubscriber=i.updateSubscriber.bind(Object(l.a)(i)),i.saveCountdownsToLocalStorage=i.saveCountdownsToLocalStorage.bind(Object(l.a)(i)),i}return Object(u.a)(n,[{key:"getNextCountdown",value:function(){return this.state.countdowns[this.nextCountdownIndex]}},{key:"updateCountdownState",value:function(t){this.setState({secondsLeft:t.secondsLeft,running:t.running}),this.saveCountdownsToLocalStorage()}},{key:"saveCountdownsToLocalStorage",value:function(){localStorage.setItem("countdowns",JSON.stringify(this.state.countdowns.map((function(t){return t.exportToJsonObject()}))))}},{key:"updateSubscriber",value:function(){this.updateCountdownState(this.currentCountdown),this.currentCountdown.running||(tt.showNotification(Z,{body:"".concat(this.currentCountdown.name," done")}),this.currentCountdown.unsubscribe(this.constructor.name))}},{key:"startTimer",value:function(){this.currentCountdown.subscribe(this.constructor.name,this.updateSubscriber),this.currentCountdown.start()}},{key:"stopTimer",value:function(){this.currentCountdown.unsubscribe(this.constructor.name),this.currentCountdown.stop(),this.updateCountdownState(this.currentCountdown),this.setState({currentCountdownIndex:this.nextCountdownIndex}),localStorage.setItem("currentCountdownIndex",this.nextCountdownIndex.toString())}},{key:"handleStartStopOnClick",value:function(){this.state.running?this.stopTimer():this.startTimer()}},{key:"renderSliders",value:function(){var t=this;return this.state.countdowns.map((function(e){return Object(i.jsx)(m.a,{item:!0,children:Object(i.jsx)(J,{label:e.name,labelSuffix:"m",value:e.value,step:1,min:e.min,max:e.max,onChange:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;i.value=n,t.saveCountdownsToLocalStorage()},onEditSave:function(n,i,a){e.name=n,e.min=i,e.max=a,t.saveCountdownsToLocalStorage()},formatCallback:function(t){return Y.minutes(t)}})},e.name)}))}},{key:"componentDidMount",value:function(){tt.requestDesktopNotificationPermissions();var t=localStorage.getItem("currentCountdownIndex"),e=localStorage.getItem("countdowns");if(null!==e){var n=JSON.parse(e).map((function(t){return(new X).loadFromJsonObject(t)}));this.setState({countdowns:n});var i=n.filter((function(t){return t.running}))[0];i&&(i.update(),i.subscribe(this.constructor.name,this.updateSubscriber),this.updateCountdownState(i))}this.setState({currentCountdownIndex:t?parseInt(t):this.state.currentCountdownIndex})}},{key:"render",value:function(){var t=this,e=this.props.classes;return Object(i.jsxs)("div",{className:e.root,children:[Object(i.jsx)(p.a,{position:"static",children:Object(i.jsxs)(j.a,{children:[Object(i.jsx)(x.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",onClick:function(){t.setState({sidebarOpen:!0})},children:Object(i.jsx)(k.a,{})}),Object(i.jsx)(v.a,{variant:"h6",className:e.title,children:Z})]})}),Object(i.jsx)(Q,{onOpen:function(){return t.state.sidebarOpen},onClose:function(){t.setState({sidebarOpen:!1})}}),Object(i.jsxs)(m.a,{container:!0,className:e.gridContainer,spacing:2,children:[Object(i.jsxs)(m.a,{item:!0,xs:12,lg:2,children:[" ",Object(i.jsx)(g.a,{className:e.paperContainer,children:Object(i.jsxs)(m.a,{container:!0,direction:"column",spacing:2,children:[Object(i.jsx)(m.a,{item:!0,children:Object(i.jsx)(v.a,{variant:"h5",children:"Timers"})}),Object(i.jsx)(m.a,{item:!0,children:this.renderSliders()}),Object(i.jsx)(m.a,{item:!0,children:Object(i.jsx)(w.a,{variant:"contained",className:e.fillWidth,onClick:this.handleStartStopOnClick,children:this.state.running?"Stop":"Start"})})]})})," "]}),Object(i.jsx)(m.a,{item:!0,xs:!0,children:Object(i.jsxs)(g.a,{className:e.paperContainer,children:[Object(i.jsxs)(v.a,{variant:"h5",children:[this.state.running?"Running":"On deck",": ",this.currentCountdown.name]}),Object(i.jsxs)(v.a,{variant:"h6",children:["Time left ",Y.seconds(this.state.secondsLeft)]}),Object(i.jsxs)(v.a,{variant:"caption",children:["Up next: ",this.getNextCountdown().name]})]})})]})]})}},{key:"currentCountdown",get:function(){return this.state.countdowns[this.state.currentCountdownIndex]}},{key:"nextCountdownIndex",get:function(){return(this.state.currentCountdownIndex+1)%this.state.countdowns.length}}]),n}(a.Component));o.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(et,{})}),document.getElementById("root"))}},[[151,1,2]]]);
//# sourceMappingURL=main.ddd0ec57.chunk.js.map